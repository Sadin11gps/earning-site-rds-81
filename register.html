<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>Register | Earning Site</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Optional: পরে auth.css যোগ করব -->
  <style>
    /* Minimal inline styles so it looks clean even before auth.css */
    :root { color-scheme: light dark; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif; background: #0f1320; color: #e6e7ff; }
    .page { max-width: 520px; margin: 0 auto; padding: 18px 14px; }
    .card { background: #1a1f34; border: 1px solid #2b3050; border-radius: 14px; padding: 16px; box-shadow: 0 8px 18px rgba(0,0,0,0.25); }
    h1 { margin: 0 0 14px; font-size: 20px; }
    .field { margin: 10px 0; }
    .label { display: block; font-size: 14px; margin-bottom: 6px; color: #c9ccff; }
    input { width: 100%; padding: 10px 12px; border-radius: 10px; border: 1px solid #2b3050; background: #0f1320; color: #fff; }
    .hint { font-size: 12px; color: #aab0ff; margin-top: 4px; }
    .row { display: flex; gap: 10px; }
    button { width: 100%; margin-top: 12px; padding: 12px 14px; border: 1px solid #2b3050; border-radius: 10px; background: #6EC1E4; color: #0f1320; font-weight: 800; cursor: pointer; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    .note { margin-top: 12px; font-size: 13px; color: #c9ccff; }
    .error { background: #3b1a1a; border: 1px solid #8b2b2b; color: #ffd7d7; padding: 10px; border-radius: 10px; margin: 10px 0; display: none; }
    .success { background: #153b21; border: 1px solid #2b8b4c; color: #d7ffdf; padding: 10px; border-radius: 10px; margin: 10px 0; display: none; }
    .link { color: #6EC1E4; text-decoration: none; font-weight: 700; }
  </style>
</head>
<body>
  <div class="page">
    <div class="card">
      <h1>Register</h1>

      <div id="msgError" class="error"></div>
      <div id="msgSuccess" class="success"></div>

      <form id="registerForm" novalidate>
        <div class="field">
          <label class="label" for="name">নাম</label>
          <input id="name" type="text" placeholder="আপনার নাম" required />
        </div>

        <div class="field">
          <label class="label" for="email">ইমেইল</label>
          <input id="email" type="email" placeholder="you@example.com" required />
        </div>

        <div class="row">
          <div class="field" style="flex:1">
            <label class="label" for="password">পাসওয়ার্ড</label>
            <input id="password" type="password" placeholder="কমপক্ষে 6 অক্ষর" required minlength="6" />
          </div>
          <div class="field" style="flex:1">
            <label class="label" for="confirm">কনফার্ম পাসওয়ার্ড</label>
            <input id="confirm" type="password" placeholder="পুনরায় লিখুন" required minlength="6" />
          </div>
        </div>
        <div class="hint">পাসওয়ার্ড দুইবার একই হতে হবে।</div>

        <div class="field">
          <label class="label" for="referral">Referral code (অপশনাল)</label>
          <input id="referral" type="text" placeholder="যদি থাকে, যেমন REF123" />
        </div>

        <button id="btnRegister" type="submit">Register</button>
      </form>

      <p class="note">
        ইতিমধ্যেই অ্যাকাউন্ট আছে?
        <a class="link" href="login.html">Login</a>
      </p>
    </div>
  </div>

  <script>
    // Minimal inline script for UX; পরের ধাপে পূর্ণ auth.js দেবো
    const API_BASE = "/api";

    const form = document.getElementById("registerForm");
    const btn = document.getElementById("btnRegister");
    const msgError = document.getElementById("msgError");
    const msgSuccess = document.getElementById("msgSuccess");

    function showError(text) {
      msgSuccess.style.display = "none";
      msgError.textContent = text;
      msgError.style.display = "block";
    }
    function showSuccess(text) {
      msgError.style.display = "none";
      msgSuccess.textContent = text;
      msgSuccess.style.display = "block";
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;
      const confirm = document.getElementById("confirm").value;
      const referral = document.getElementById("referral").value.trim();

      // Basic validation
      if (!name || !email || !password || !confirm) {
        showError("সব ঘর পূরণ করুন।");
        return;
      }
      if (password.length < 6) {
        showError("পাসওয়ার্ড কমপক্ষে 6 অক্ষরের হতে হবে।");
        return;
      }
      if (password !== confirm) {
        showError("পাসওয়ার্ড মিলছে না।");
        return;
      }

      // Submit
      btn.disabled = true;
      btn.textContent = "Processing…";
      try {
        const res = await fetch(`${API_BASE}/register`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email, password, referralCode: referral })
        });
        const data = await res.json();

        if (!res.ok) {
          showError(data.error || "রেজিস্ট্রেশন ব্যর্থ হয়েছে।");
        } else {
          showSuccess(data.message || "রেজিস্ট্রেশন সফল।");
          // Optional: redirect after short delay
          setTimeout(() => {
            window.location.href = "login.html";
          }, 1200);
        }
      } catch (err) {
        showError("নেটওয়ার্ক সমস্যা। পরে চেষ্টা করুন।");
      } finally {
        btn.disabled = false;
        btn.textContent = "Register";
      }
    });
  </script>
</body>
</html>

